{"ast":null,"code":"import _asyncToGenerator from \"F:/Projects/Project Square/Template/project_square/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { Gatekeeper } from 'gatekeeper-client-sdk';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/router\";\nimport * as i2 from \"ngx-toastr\";\nimport * as i3 from \"@angular/common/http\";\nexport class AppService {\n  constructor(router, toastr, http) {\n    this.router = router;\n    this.toastr = toastr;\n    this.http = http;\n    this.user = null;\n    this.baseUrl = 'https://reqres.in/api/login';\n  }\n  // async loginByAuth({email, password}) {\n  //     alert(email)\n  //     try {\n  //         const token = await Gatekeeper.loginByAuth(email, password);\n  //         localStorage.setItem('token', token);\n  //         // await this.getProfile();\n  //         this.router.navigate(['/']);\n  //         this.toastr.success('Login success');\n  //     } catch (error) {\n  //         this.toastr.error(error.message);\n  //     }\n  // }\n  loginByAuth({\n    email,\n    password\n  }) {\n    var _this = this;\n    return _asyncToGenerator(function* () {\n      alert(\"email: \" + email);\n      // eve.holt@reqres.in\n      // cityslicka\n      try {\n        const response = yield _this.http.post(`${_this.baseUrl}`, {\n          email,\n          password\n        }).toPromise();\n        const token = response['token'];\n        localStorage.setItem('token', token);\n        localStorage.setItem('gatekeeper_token', token);\n        _this.router.navigate(['/']);\n        _this.toastr.success('Login success');\n      } catch (error) {\n        _this.toastr.error(error.message);\n      }\n    })();\n  }\n  registerByAuth({\n    email,\n    password\n  }) {\n    var _this2 = this;\n    return _asyncToGenerator(function* () {\n      try {\n        const token = yield Gatekeeper.registerByAuth(email, password);\n        localStorage.setItem('token', token);\n        yield _this2.getProfile();\n        _this2.router.navigate(['/']);\n        _this2.toastr.success('Register success');\n      } catch (error) {\n        _this2.toastr.error(error.message);\n      }\n    })();\n  }\n  // async getProfile() {\n  //     try {\n  //         this.user = await Gatekeeper.getProfile();\n  //     } catch (error) {\n  //         this.logout();\n  //         throw error;\n  //     }\n  // }\n  logout() {\n    localStorage.removeItem('token');\n    localStorage.removeItem('gatekeeper_token');\n    this.user = null;\n    this.router.navigate(['/login']);\n  }\n  static #_ = this.ɵfac = function AppService_Factory(t) {\n    return new (t || AppService)(i0.ɵɵinject(i1.Router), i0.ɵɵinject(i2.ToastrService), i0.ɵɵinject(i3.HttpClient));\n  };\n  static #_2 = this.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n    token: AppService,\n    factory: AppService.ɵfac,\n    providedIn: 'root'\n  });\n}","map":{"version":3,"mappings":";AAGA,SAAQA,UAAU,QAAO,uBAAuB;;;;;AAOhD,OAAM,MAAOC,UAAU;EAInBC,YAAoBC,MAAc,EAAUC,MAAqB,EAAUC,IAAgB;IAAvE,WAAM,GAANF,MAAM;IAAkB,WAAM,GAANC,MAAM;IAAyB,SAAI,GAAJC,IAAI;IAHxE,SAAI,GAAQ,IAAI;IACf,YAAO,GAAG,6BAA6B;EAE+C;EAE9F;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EAEMC,WAAW,CAAC;IAACC,KAAK;IAAEC;EAAQ,CAAC;IAAA;IAAA;MAC/BC,KAAK,CAAC,SAAS,GAAEF,KAAK,CAAC;MACvB;MACA;MACA,IAAG;QACC,MAAMG,QAAQ,SAAS,KAAI,CAACL,IAAI,CAACM,IAAI,CAAC,GAAG,KAAI,CAACC,OAAO,EAAE,EAAE;UAAEL,KAAK;UAAEC;QAAQ,CAAE,CAAC,CAACK,SAAS,EAAE;QACzF,MAAMC,KAAK,GAAGJ,QAAQ,CAAC,OAAO,CAAC;QAC/BK,YAAY,CAACC,OAAO,CAAC,OAAO,EAAEF,KAAK,CAAC;QACpCC,YAAY,CAACC,OAAO,CAAC,kBAAkB,EAAEF,KAAK,CAAC;QAC/C,KAAI,CAACX,MAAM,CAACc,QAAQ,CAAC,CAAC,GAAG,CAAC,CAAC;QAC3B,KAAI,CAACb,MAAM,CAACc,OAAO,CAAC,eAAe,CAAC;OACvC,QAAOC,KAAK,EAAE;QACX,KAAI,CAACf,MAAM,CAACe,KAAK,CAACA,KAAK,CAACC,OAAO,CAAC;;IACnC;EACL;EAEMC,cAAc,CAAC;IAACd,KAAK;IAAEC;EAAQ,CAAC;IAAA;IAAA;MAClC,IAAI;QACA,MAAMM,KAAK,SAASd,UAAU,CAACqB,cAAc,CAACd,KAAK,EAAEC,QAAQ,CAAC;QAC9DO,YAAY,CAACC,OAAO,CAAC,OAAO,EAAEF,KAAK,CAAC;QACpC,MAAM,MAAI,CAACQ,UAAU,EAAE;QACvB,MAAI,CAACnB,MAAM,CAACc,QAAQ,CAAC,CAAC,GAAG,CAAC,CAAC;QAC3B,MAAI,CAACb,MAAM,CAACc,OAAO,CAAC,kBAAkB,CAAC;OAC1C,CAAC,OAAOC,KAAK,EAAE;QACZ,MAAI,CAACf,MAAM,CAACe,KAAK,CAACA,KAAK,CAACC,OAAO,CAAC;;IACnC;EACL;EAEA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EAEAG,MAAM;IACFR,YAAY,CAACS,UAAU,CAAC,OAAO,CAAC;IAChCT,YAAY,CAACS,UAAU,CAAC,kBAAkB,CAAC;IAC3C,IAAI,CAACC,IAAI,GAAG,IAAI;IAChB,IAAI,CAACtB,MAAM,CAACc,QAAQ,CAAC,CAAC,QAAQ,CAAC,CAAC;EACpC;EAAC;qBA7DQhB,UAAU;EAAA;EAAA;WAAVA,UAAU;IAAAyB,SAAVzB,UAAU;IAAA0B,YAFP;EAAM","names":["Gatekeeper","AppService","constructor","router","toastr","http","loginByAuth","email","password","alert","response","post","baseUrl","toPromise","token","localStorage","setItem","navigate","success","error","message","registerByAuth","getProfile","logout","removeItem","user","factory","providedIn"],"sourceRoot":"","sources":["F:\\Projects\\Project Square\\Template\\project_square\\src\\app\\services\\app.service.ts"],"sourcesContent":["import {Injectable} from '@angular/core';\nimport {Router} from '@angular/router';\nimport {ToastrService} from 'ngx-toastr';\nimport {Gatekeeper} from 'gatekeeper-client-sdk';\nimport { HttpClient } from '@angular/common/http';\nimport { Observable } from 'rxjs/internal/Observable';\n\n@Injectable({\n    providedIn: 'root'\n})\nexport class AppService {\n    public user: any = null;\n    private baseUrl = 'https://reqres.in/api/login';\n\n    constructor(private router: Router, private toastr: ToastrService, private http: HttpClient) {}\n\n    // async loginByAuth({email, password}) {\n    //     alert(email)\n    //     try {\n    //         const token = await Gatekeeper.loginByAuth(email, password);\n    //         localStorage.setItem('token', token);\n    //         // await this.getProfile();\n    //         this.router.navigate(['/']);\n    //         this.toastr.success('Login success');\n    //     } catch (error) {\n    //         this.toastr.error(error.message);\n    //     }\n    // }\n\n    async loginByAuth({email, password}){\n        alert(\"email: \"+ email)\n        // eve.holt@reqres.in\n        // cityslicka\n        try{\n            const response = await this.http.post(`${this.baseUrl}`, { email, password }).toPromise();\n            const token = response['token'];\n            localStorage.setItem('token', token);\n            localStorage.setItem('gatekeeper_token', token);\n            this.router.navigate(['/']);\n            this.toastr.success('Login success');\n        }catch (error) {\n            this.toastr.error(error.message);\n        }\n    }\n\n    async registerByAuth({email, password}) {\n        try {\n            const token = await Gatekeeper.registerByAuth(email, password);\n            localStorage.setItem('token', token);\n            await this.getProfile();\n            this.router.navigate(['/']);\n            this.toastr.success('Register success');\n        } catch (error) {\n            this.toastr.error(error.message);\n        }\n    }\n\n    // async getProfile() {\n    //     try {\n    //         this.user = await Gatekeeper.getProfile();\n    //     } catch (error) {\n    //         this.logout();\n    //         throw error;\n    //     }\n    // }\n\n    logout() {\n        localStorage.removeItem('token');\n        localStorage.removeItem('gatekeeper_token');\n        this.user = null;\n        this.router.navigate(['/login']);\n    }\n}\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}